ll solve (ll a, ll b, ll m) {
  ll n = (ll) sqrtl (m + .0) + 1;
 
  ll an = 1;
  for (ll i = 0; i < n; ++i)
    an = ((__int128)an * a) % m;
 
  map<ll, ll> vals;
  for (ll i = 1, cur = an; i <= n; ++i) {
    if (!vals.count(cur))
      vals[cur] = i;
    cur = ((__int128)cur * an) % m;
  }
 
  for (ll i = 0, cur = b; i <= n; ++i) {
    if (vals.count(cur)) {
      ll ans = vals[cur] * n - i;
      if (ans < m)
        return ans;
    }
    cur = ((__int128)cur * a) % m;
  }
  return -1;
}
